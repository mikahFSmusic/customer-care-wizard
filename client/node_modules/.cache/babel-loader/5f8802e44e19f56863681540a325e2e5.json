{"ast":null,"code":"var _jsxFileName = \"/Users/mfs/Desktop/e m p l o y m e n t/Maisonette/Projects/damage-defect-wizard/client/src/modules/auth/AuthContext.tsx\";\nimport React, { createContext, useCallback, useContext, useEffect, useState } from \"react\";\nimport { auth } from \"../../firebase\";\nimport firebase from \"firebase/app\";\nexport const DEFAULT_AUTH_CONTEXT_VALUE = {\n  checkedAuth: false,\n  currentUser: null,\n  signedIn: false,\n  signInWithGoogle: async () => {\n    return;\n  },\n  signOut: async () => {\n    return;\n  }\n};\nexport const AuthContext = createContext(DEFAULT_AUTH_CONTEXT_VALUE);\nexport const AuthProvider = props => {\n  const [currentUser, setCurrentUser] = useState();\n  const [signedIn, setSignedIn] = useState(false);\n  const [checkedAuth, setCheckedAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const signInWithGoogle = async () => {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    return auth.signInWithRedirect(provider);\n  };\n\n  const signOut = useCallback(async () => {\n    return auth.signOut();\n  }, []);\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(currentUser => {\n      console.log(\"unsubscribe triggered\");\n      setCheckedAuth(true);\n      setLoading(false);\n\n      if (!currentUser) {\n        setSignedIn(false);\n        setCurrentUser(null);\n      } else {\n        setCurrentUser(currentUser);\n        setSignedIn(true);\n        console.log(\"signed in\");\n        console.log(currentUser);\n      }\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      currentUser,\n      signInWithGoogle,\n      signOut,\n      signedIn,\n      checkedAuth\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }\n  }, !loading && props.children);\n};\nexport function useAuth() {\n  return useContext(AuthContext);\n}","map":{"version":3,"sources":["/Users/mfs/Desktop/e m p l o y m e n t/Maisonette/Projects/damage-defect-wizard/client/src/modules/auth/AuthContext.tsx"],"names":["React","createContext","useCallback","useContext","useEffect","useState","auth","firebase","DEFAULT_AUTH_CONTEXT_VALUE","checkedAuth","currentUser","signedIn","signInWithGoogle","signOut","AuthContext","AuthProvider","props","setCurrentUser","setSignedIn","setCheckedAuth","loading","setLoading","provider","GoogleAuthProvider","signInWithRedirect","unsubscribe","onAuthStateChanged","console","log","children","useAuth"],"mappings":";AAAA,OAAOA,KAAP,IACEC,aADF,EAEEC,WAFF,EAGEC,UAHF,EAIEC,SAJF,EAKEC,QALF,QAMO,OANP;AAOA,SAASC,IAAT,QAAqB,gBAArB;AACA,OAAOC,QAAP,MAAqB,cAArB;AAEA,OAAO,MAAMC,0BAA6C,GAAG;AAC3DC,EAAAA,WAAW,EAAE,KAD8C;AAE3DC,EAAAA,WAAW,EAAE,IAF8C;AAG3DC,EAAAA,QAAQ,EAAE,KAHiD;AAI3DC,EAAAA,gBAAgB,EAAE,YAAY;AAC5B;AACD,GAN0D;AAO3DC,EAAAA,OAAO,EAAE,YAAY;AACnB;AACD;AAT0D,CAAtD;AAYP,OAAO,MAAMC,WAAW,GAAGb,aAAa,CACtCO,0BADsC,CAAjC;AAIP,OAAO,MAAMO,YAAiD,GAAIC,KAAD,IAAW;AAC1E,QAAM,CAACN,WAAD,EAAcO,cAAd,IAAgCZ,QAAQ,EAA9C;AACA,QAAM,CAACM,QAAD,EAAWO,WAAX,IAA0Bb,QAAQ,CAAU,KAAV,CAAxC;AACA,QAAM,CAACI,WAAD,EAAcU,cAAd,IAAgCd,QAAQ,CAAU,KAAV,CAA9C;AACA,QAAM,CAACe,OAAD,EAAUC,UAAV,IAAwBhB,QAAQ,CAAU,IAAV,CAAtC;;AAEA,QAAMO,gBAAgB,GAAG,YAAY;AACnC,UAAMU,QAAQ,GAAG,IAAIf,QAAQ,CAACD,IAAT,CAAciB,kBAAlB,EAAjB;AACA,WAAOjB,IAAI,CAACkB,kBAAL,CAAwBF,QAAxB,CAAP;AACD,GAHD;;AAKA,QAAMT,OAAO,GAAGX,WAAW,CAAC,YAAY;AACtC,WAAOI,IAAI,CAACO,OAAL,EAAP;AACD,GAF0B,EAExB,EAFwB,CAA3B;AAIAT,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMqB,WAAW,GAAGnB,IAAI,CAACoB,kBAAL,CAAyBhB,WAAD,IAAiB;AAC3DiB,MAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACAT,MAAAA,cAAc,CAAC,IAAD,CAAd;AACAE,MAAAA,UAAU,CAAC,KAAD,CAAV;;AACA,UAAI,CAACX,WAAL,EAAkB;AAChBQ,QAAAA,WAAW,CAAC,KAAD,CAAX;AACAD,QAAAA,cAAc,CAAC,IAAD,CAAd;AACD,OAHD,MAGO;AACLA,QAAAA,cAAc,CAACP,WAAD,CAAd;AACAQ,QAAAA,WAAW,CAAC,IAAD,CAAX;AACAS,QAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYlB,WAAZ;AACD;AACF,KAbmB,CAApB;AAeA,WAAO,MAAM;AACXe,MAAAA,WAAW;AACZ,KAFD;AAGD,GAnBQ,EAmBN,EAnBM,CAAT;AAqBA,sBACE,oBAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AAAEf,MAAAA,WAAF;AAAeE,MAAAA,gBAAf;AAAiCC,MAAAA,OAAjC;AAA0CF,MAAAA,QAA1C;AAAoDF,MAAAA;AAApD,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGG,CAACW,OAAD,IAAYJ,KAAK,CAACa,QAHrB,CADF;AAOD,CA3CM;AA6CP,OAAO,SAASC,OAAT,GAAmB;AACxB,SAAO3B,UAAU,CAACW,WAAD,CAAjB;AACD","sourcesContent":["import React, {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport { auth } from \"../../firebase\";\nimport firebase from \"firebase/app\";\n\nexport const DEFAULT_AUTH_CONTEXT_VALUE: IAuthContextValue = {\n  checkedAuth: false,\n  currentUser: null,\n  signedIn: false,\n  signInWithGoogle: async () => {\n    return;\n  },\n  signOut: async () => {\n    return;\n  },\n};\n\nexport const AuthContext = createContext<IAuthContextValue>(\n  DEFAULT_AUTH_CONTEXT_VALUE\n);\n\nexport const AuthProvider: React.FC<IAuthContextProviderProps> = (props) => {\n  const [currentUser, setCurrentUser] = useState<firebase.User | null>();\n  const [signedIn, setSignedIn] = useState<boolean>(false);\n  const [checkedAuth, setCheckedAuth] = useState<boolean>(false);\n  const [loading, setLoading] = useState<boolean>(true);\n\n  const signInWithGoogle = async () => {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    return auth.signInWithRedirect(provider);\n  };\n\n  const signOut = useCallback(async () => {\n    return auth.signOut();\n  }, []);\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((currentUser) => {\n      console.log(\"unsubscribe triggered\");\n      setCheckedAuth(true);\n      setLoading(false);\n      if (!currentUser) {\n        setSignedIn(false);\n        setCurrentUser(null);\n      } else {\n        setCurrentUser(currentUser);\n        setSignedIn(true);\n        console.log(\"signed in\");\n        console.log(currentUser);\n      }\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n\n  return (\n    <AuthContext.Provider\n      value={{ currentUser, signInWithGoogle, signOut, signedIn, checkedAuth }}\n    >\n      {!loading && props.children}\n    </AuthContext.Provider>\n  );\n};\n\nexport function useAuth() {\n  return useContext(AuthContext);\n}\n"]},"metadata":{},"sourceType":"module"}